# Apuntes Sistemas Operativos

## Introducción

* Semana de sistemas operativos con **menos carga de trabajo** para poder descomprimir.
* Actividades destacadas:

  * Creación de virus (que otro equipo analizará).
  * Xavi regalará una PCB para soldar y escuchar la radio.
* Preparación: primero entender los conceptos, luego “chill” con hacking.
* Se realizará **cena de Navidad típica**.

---

## 1. Sistemas de Archivos

### Concepto

Conjunto de estrategias y métodos para que el **Sistema Operativo (SO)** use y almacene información.

### Funciones principales

* Gestión del almacenamiento.
* Organización jerárquica desde la raíz con subdirectorios.
* Manejo de **metadatos** y control de acceso.
* Operaciones básicas sobre archivos.

### Componentes

* **Archivo**: unidad básica de información.

  * Nombre único por directorio.
  * Posee persistencia.
  * Estructura desde sencilla hasta compleja.
* **Directorio**: archivo que contiene archivos o subdirectorios.
* **Metadatos**: descriptivos (nombre, longitud), administrativos (propietario, permisos), estructurales (orden de páginas).

### Tipos de almacenamiento

* FAT32 y exFAT: antiguos pero universales, con limitaciones.
* NTFS: estándar en Windows.
* EXT3/EXT4: Linux.
* HFS+/APFS: Apple.

### Características adicionales

* **Journaling**: registro de cambios para evitar corrupción y mejorar restauración.
* **Bloques y Clusters**: división de archivos en fragmentos.
* **Localización de archivos**:

  * Tabla FAT (punteros encadenados).
  * Inodos (Linux).
* **Fragmentación**: problemas al borrar archivos; se soluciona con **desfragmentación** (HDD: 1-3 meses, SSD: no necesario).
* Diferencias entre HDD y SSD: rendimiento y método de lectura/escritura.

---

## 2. Drivers

### Concepto

* Software que permite que el **SO reconozca y use un dispositivo**.
* Comunica hardware con SO.

### Tipos de dispositivos

* Bloques (disco), carácter (teclado), red, otros (pantalla, sonido).

### Funciones

* Leer y escribir (ioctl).
* Manejo de interrupciones: PIC 8256, APIC y MSI.
* DMA vs Polling: DMA permite transferencias directas sin cargar CPU; polling consulta constantemente el dispositivo.

### Identificación

* **Números mayor y menor**: diferencian dispositivos similares.

---

## 3. Espacio de Usuario vs Kernel

### Espacio de Usuario

* Interfaz intuitiva para el usuario.
* Acciones limitadas por seguridad y estabilidad.

### Kernel

* Controla todo y protege recursos críticos.
* **Syscalls**: solicitudes de servicios del usuario al Kernel (read, write, open, close, fork, execve).
* Cambio de contexto: transición de usuario a Kernel y viceversa.
* Privilegios: el Kernel limita ciertas operaciones críticas.
* **VDSO (Virtual Dynamic Shared Object)**: mejora rendimiento y seguridad de syscalls.

### Multitarea y protección

* **Multitarea cooperativa**: proceso cede el control voluntariamente.
* **Multitarea apropiativa**: el sistema decide cuándo un proceso debe ejecutarse.
* Protección de memoria mediante tablas de control.

---

## 4. Bootloader

### Concepto

Programa que se ejecuta al encender el PC y carga el Kernel.

### Tipos

* **Etapa única**: simple, todo en un bloque.
* **Multi-stage**: más complejo, carga en cadena.

### MBR y GPT

* **MBR (Master Boot Record)**: 512 bytes, tabla de particiones, firma 0x55AA.
* **GPT**: moderno, permite discos y particiones grandes, usado en UEFI.

### Secuencia de arranque

* BIOS/UEFI ejecuta MBR.
* Chain loader carga **Volume Boot Record** y Kernel.
* Manejo de interrupciones y cabeceras ELF.
